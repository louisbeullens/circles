<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="./vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>constellation</title>
    <script type="module">var{PI:e,sin:t,cos:n,sqrt:r,pow:i}=Math,a=`http://www.w3.org/2000/svg`,o=document.querySelector(`#scene`),s=class{constructor(e,t,n,r,i){this.centerId=e,this.center=t,this.radius=n,this.angle=r,this.scale=i}},c=class{constructor(e,t,n,r){this.position=e,this.locationA=t,this.locationB=n,this.element=r}};function l(t){return t/180*e}function u(e,t,n,a,o,s){let c=i(a-e,2)+i(o-t,2),l=r(c),u=(i(n,2)-i(s,2)+c)/(2*l),d=r(i(n,2)-i(u,2)),f=e+u*(a-e)/l,p=t+u*(o-t)/l;return[f-d*(o-t)/l,p+d*(a-e)/l,f+d*(o-t)/l,p-d*(a-e)/l]}function d(e,t={}){let n=document.createElementNS(a,e);for(let[e,r]of Object.entries(t))n.setAttribute(e,String(r));return n}function f(t,n){return(Math.atan2(n.y-t.y,n.x-t.x)*180/e+360)%360}var p=null;function m(){let e=window.innerWidth,i=window.innerHeight;o.setAttribute(`viewBox`,`${-e/2} ${-i/2} ${e} ${i}`),o.replaceChildren();let a=d(`g`,{transform:`scale(1,-1)`}),m=100*t(l(120)),h=100*n(l(120)),_=100*t(l(240)),v=100*n(l(240)),y=100*r(3),b=[.85,1,1.15];for(let e of b){let t=y*e;a.append(d(`circle`,{cx:0,cy:100,r:t,class:`orbit`})),a.append(d(`circle`,{cx:m,cy:h,r:t,class:`orbit`})),a.append(d(`circle`,{cx:_,cy:v,r:t,class:`orbit`}))}let x=[],S=[];p={c0:{x:0,y:100},c1:{x:m,y:h},c2:{x:_,y:v}};let C=[{a:{id:`c2`,x:_,y:v},b:{id:`c1`,x:m,y:h},colors:[`white`,`yellow`]},{a:{id:`c1`,x:m,y:h},b:{id:`c0`,x:0,y:100},colors:[`orange`,`red`]},{a:{id:`c0`,x:0,y:100},b:{id:`c2`,x:_,y:v},colors:[`green`,`blue`]}];for(let e of C)for(let t=0;t<b.length;t++)for(let n=0;n<b.length;n++){let r=b[t],i=b[n],o=y*r,l=y*i,[p,m,h,_]=u(e.a.x,e.a.y,o,e.b.x,e.b.y,l),v=[{x:p,y:m},{x:h,y:_}].sort((e,t)=>f({x:0,y:0},e)-f({x:0,y:0},t));for(let t=0;t<v.length;t++){let n=v[t],u=d(`circle`,{cx:n.x,cy:n.y,r:10,class:`node`,fill:e.colors[t],stroke:`grey`}),p=new s(e.a.id,{x:e.a.x,y:e.a.y},o,f({x:e.a.x,y:e.a.y},n),r),m=new s(e.b.id,{x:e.b.x,y:e.b.y},l,f({x:e.b.x,y:e.b.y},n),i),h=[e.a.id,e.b.id].sort(),_=e.a.id===h[0]?new c(n,p,m,u):new c(n,m,p,u);S.push(_),u.addEventListener(`click`,e=>{e.stopPropagation(),g(_)}),x.push(u),a.append(u)}}return o.append(a),S}var h=m();window.addEventListener(`resize`,()=>{h=m()});function g(e){if(e.locationA.scale===1&&e.locationB.scale===1){let t=e.element.getAttribute(`fill`),n=[`yellow`,`green`,`orange`].includes(t),r=v(e.locationA.centerId,e.locationB.centerId),i=p?.[r];if(!i)return;n?_(i,1.15,3):_(i,.85,-3)}console.log(`Intersection:`,{position:e.position,locationA:e.locationA,locationB:e.locationB})}function _(e,t,n){let r=h.map(n=>n.locationA.scale===t&&n.locationA.center.x===e.x&&n.locationA.center.y===e.y?{hit:n,angle:n.locationA.angle}:n.locationB.scale===t&&n.locationB.center.x===e.x&&n.locationB.center.y===e.y?{hit:n,angle:n.locationB.angle}:null).filter(Boolean).sort((e,t)=>e.angle-t.angle);if(r.length===0)return;let i=r.map(e=>e.hit.element.getAttribute(`fill`)),a=r.map((e,t)=>i[(t-n+i.length)%i.length]);for(let e=0;e<r.length;e++)r[e].hit.element.setAttribute(`fill`,a[e])}function v(e,t){for(let n of[`c0`,`c1`,`c2`])if(n!==e&&n!==t)return n;return`c0`}</script>
    <style rel="stylesheet" crossorigin>*{box-sizing:border-box}html,body{background:#f7f2e8;width:100%;height:100%;margin:0}svg{width:100vw;height:100vh;position:fixed;inset:0}.orbit{fill:none;stroke:#1a1a1a;stroke-width:1.5px;opacity:.75}.node{stroke-width:1px}
/*$vite$:1*/</style>
  </head>
  <body>
    <svg id="scene" aria-hidden="true"></svg>
  </body>
</html>
